basedir = '../../chrome/content/'

describe 'VideoSet', ->

  doc = null
  Collector = null
  videoSet = null

  beforeEach ->
    doc = createSpyObj('doc', ['getElementById'])
    Collector = createSpyObj('Collector', ['data'])
    Collector.data.andReturn('<script>var ytplayer = ytplayer || {};ytplayer.config = {"attrs": {"id": "movie_player"}, "assets": {"js": "http:\/\/s.ytimg.com\/yts\/jsbin\/html5player-vflTmL8df.js", "css": "http:\/\/s.ytimg.com\/yts\/cssbin\/www-player-vflVlcxS2.css", "html": "\/html5_player_template"}, "url_v8": "http:\/\/s.ytimg.com\/yts\/swfbin\/cps-vflF6kCRZ.swf", "min_version": "8.0.0", "args": {"cc_asr": 1, "url_encoded_fmt_stream_map": "fallback_host=tc.v1.cache1.c.youtube.com\u0026itag=45\u0026quality=hd720\u0026type=video%2Fwebm%3B+codecs%3D%22vp8.0%2C+vorbis%22\u0026sig=2B7D1F37587E27175DC36CA297F26996A94BEA0C.9A7FC1470DFCEA45D1A2504E8A96E9C8B0B79CDE\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D45%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26sparams%3Dcp%252Cid%252Cip%252Cipbits%252Citag%252Cratebypass%252Csource%252Cupn%252Cexpire%26source%3Dyoutube%26ms%3Dau%26id%3Db9826ed67303b2fc%26ratebypass%3Dyes%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421%26newshard%3Dyes,fallback_host=tc.v15.cache4.c.youtube.com\u0026itag=22\u0026quality=hd720\u0026type=video%2Fmp4%3B+codecs%3D%22avc1.64001F%2C+mp4a.40.2%22\u0026sig=10F0B9BC72828137E251F51FFA5A45A5BC069DE3.D3643DEA8B5FEDAD5A5B33DDE6D326023A50B734\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D22%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26sparams%3Dcp%252Cid%252Cip%252Cipbits%252Citag%252Cratebypass%252Csource%252Cupn%252Cexpire%26source%3Dyoutube%26ms%3Dau%26id%3Db9826ed67303b2fc%26ratebypass%3Dyes%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421%26newshard%3Dyes,fallback_host=tc.v9.cache6.c.youtube.com\u0026itag=44\u0026quality=large\u0026type=video%2Fwebm%3B+codecs%3D%22vp8.0%2C+vorbis%22\u0026sig=06F9F0A455D33CF64CCCDDD6BF11A4D480E6D464.6EC6A1852851E520E88E08598B3938D42AD4405E\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D44%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26sparams%3Dcp%252Cid%252Cip%252Cipbits%252Citag%252Cratebypass%252Csource%252Cupn%252Cexpire%26source%3Dyoutube%26ms%3Dau%26id%3Db9826ed67303b2fc%26ratebypass%3Dyes%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421%26newshard%3Dyes,fallback_host=tc.v16.cache3.c.youtube.com\u0026itag=35\u0026quality=large\u0026type=video%2Fx-flv\u0026sig=AB92407AC1543564FAAE197DC323C48DD472A88C.31FE0377B724E6AA04A309CC517C85CDDDAFE0DB\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D35%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26burst%3D40%26algorithm%3Dthrottle-factor%26newshard%3Dyes%26source%3Dyoutube%26factor%3D1.25%26ms%3Dau%26id%3Db9826ed67303b2fc%26sparams%3Dalgorithm%252Cburst%252Ccp%252Cfactor%252Cid%252Cip%252Cipbits%252Citag%252Csource%252Cupn%252Cexpire%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421,fallback_host=tc.v24.cache8.c.youtube.com\u0026itag=43\u0026quality=medium\u0026type=video%2Fwebm%3B+codecs%3D%22vp8.0%2C+vorbis%22\u0026sig=C65FEC5E3842B68257D1B52FA1DDAD8B34704B17.5F8E92ACBAD35DED6F1D222852965ABD95CFB137\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D43%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26sparams%3Dcp%252Cid%252Cip%252Cipbits%252Citag%252Cratebypass%252Csource%252Cupn%252Cexpire%26source%3Dyoutube%26ms%3Dau%26id%3Db9826ed67303b2fc%26ratebypass%3Dyes%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421%26newshard%3Dyes,fallback_host=tc.v3.cache5.c.youtube.com\u0026itag=34\u0026quality=medium\u0026type=video%2Fx-flv\u0026sig=1F94366C514CD035E0DD8A7E142552F45709AA8E.1B4F0EE32FB05A153A37232DA96E5D6EABFCF398\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D34%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26burst%3D40%26algorithm%3Dthrottle-factor%26newshard%3Dyes%26source%3Dyoutube%26factor%3D1.25%26ms%3Dau%26id%3Db9826ed67303b2fc%26sparams%3Dalgorithm%252Cburst%252Ccp%252Cfactor%252Cid%252Cip%252Cipbits%252Citag%252Csource%252Cupn%252Cexpire%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421,fallback_host=tc.v9.cache3.c.youtube.com\u0026itag=18\u0026quality=medium\u0026type=video%2Fmp4%3B+codecs%3D%22avc1.42001E%2C+mp4a.40.2%22\u0026sig=704CC9DDC876921E29417736685FA7CBDCCD6D30.8B94AE21E7CCE609922285B16C17E4FF21805B80\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D18%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26sparams%3Dcp%252Cid%252Cip%252Cipbits%252Citag%252Cratebypass%252Csource%252Cupn%252Cexpire%26source%3Dyoutube%26ms%3Dau%26id%3Db9826ed67303b2fc%26ratebypass%3Dyes%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421%26newshard%3Dyes,fallback_host=tc.v16.cache7.c.youtube.com\u0026itag=5\u0026quality=small\u0026type=video%2Fx-flv\u0026sig=C0B52E3E57AF27D1762FD4BFC675A49B195E8F87.5543B3C2964AB1CB1B7D78E5F30BD27F200BC1A5\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D5%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26burst%3D40%26algorithm%3Dthrottle-factor%26newshard%3Dyes%26source%3Dyoutube%26factor%3D1.25%26ms%3Dau%26id%3Db9826ed67303b2fc%26sparams%3Dalgorithm%252Cburst%252Ccp%252Cfactor%252Cid%252Cip%252Cipbits%252Citag%252Csource%252Cupn%252Cexpire%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421,fallback_host=tc.v24.cache3.c.youtube.com\u0026itag=36\u0026quality=small\u0026type=video%2F3gpp%3B+codecs%3D%22mp4v.20.3%2C+mp4a.40.2%22\u0026sig=78EBDA3CE95C82A4AD6E00A7F196FE0480A1D7C5.33F7A630E7306E1F8993F20BD2DFDDAB905A7076\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D36%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26burst%3D40%26algorithm%3Dthrottle-factor%26newshard%3Dyes%26source%3Dyoutube%26factor%3D1.25%26ms%3Dau%26id%3Db9826ed67303b2fc%26sparams%3Dalgorithm%252Cburst%252Ccp%252Cfactor%252Cid%252Cip%252Cipbits%252Citag%252Csource%252Cupn%252Cexpire%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421,fallback_host=tc.v16.cache7.c.youtube.com\u0026itag=17\u0026quality=small\u0026type=video%2F3gpp%3B+codecs%3D%22mp4v.20.3%2C+mp4a.40.2%22\u0026sig=5F5239DA1CF8B996D3826E3580D8EFD308134E.54B00C3377C86876C24BC0A4BEE6CC57B07D3961\u0026url=http%3A%2F%2Fr3---sn-2apm-f5fz.c.youtube.com%2Fvideoplayback%3Ffexp%3D913571%252C921713%252C916624%252C913806%252C932000%252C932004%252C906383%252C902000%252C901208%252C919512%252C929903%252C925714%252C931202%252C900821%252C900823%252C931203%252C931401%252C906090%252C909419%252C908529%252C930807%252C919373%252C930803%252C906836%252C920201%252C929602%252C930101%252C926403%252C900824%252C910223%26itag%3D17%26cp%3DU0hVSlRSUV9KU0NONV9MTFVEOkpRWnN4X21kVVhO%26upn%3D0hu4J25qBhc%26ip%3D213.111.71.103%26key%3Dyt1%26expire%3D1365473359%26sver%3D3%26burst%3D40%26algorithm%3Dthrottle-factor%26newshard%3Dyes%26source%3Dyoutube%26factor%3D1.25%26ms%3Dau%26id%3Db9826ed67303b2fc%26sparams%3Dalgorithm%252Cburst%252Ccp%252Cfactor%252Cid%252Cip%252Cipbits%252Citag%252Csource%252Cupn%252Cexpire%26mv%3Dm%26ipbits%3D8%26mt%3D1365449421", "ttsurl": "http:\/\/www.youtube.com\/api\/timedtext?expire=1365474660\u0026signature=F1656F688B83CB50D4ADCC8E1BBD8085276CAABF.76CDD4C1022F54AC9E6BF8FA71EC6EEED1806121\u0026hl=en_US\u0026asr_langs=ja%2Cpt%2Cde%2Cko%2Cru%2Cen%2Cnl%2Ces%2Cfr%2Cit\u0026sparams=asr_langs%2Ccaps%2Cv%2Cexpire\u0026v=uYJu1nMDsvw\u0026caps=asr\u0026key=yttt1", "video_id": "uYJu1nMDsvw", "sendtmp": "1", "length_seconds": 534, "enablecsi": "1", "enablejsapi": 1, "account_playback_token": "", "vq": "auto", "no_get_video_log": "1", "cc_font": "Arial Unicode MS, arial, verdana, _sans", "share_icons": "http:\/\/s.ytimg.com\/yts\/swfbin\/sharing-vflQcYXsR.swf", "cr": "UA", "ptk": "youtube_none", "cos": "X11", "storyboard_spec": "http:\/\/i2.ytimg.com\/sb\/uYJu1nMDsvw\/storyboard3_L$L\/$N.jpg|48#27#100#10#10#0#default#CT9qogycLiJcKNKnZsvjqjnMXXk|80#45#108#10#10#5000#M$M#N1fydnZ757T8Fzg3F9vNWMTLzHM|160#90#108#5#5#5000#M$M#uOjugi8pbGsu-UZYz8hJIo6xEwk", "timestamp": 1365449460, "fexp": "913571,921713,916624,913806,932000,932004,906383,902000,901208,919512,929903,925714,931202,900821,900823,931203,931401,906090,909419,908529,930807,919373,930803,906836,920201,929602,930101,926403,900824,910223", "plid": "AATZ3noRFIdjSysI", "sk": "UgW40SFh__RZuekJdFwvYfw18ox-3zMdC", "cc3_module": "http:\/\/s.ytimg.com\/yts\/swfbin\/subtitles3_module-vflUGOzQU.swf", "abd": "1", "cbr": "Firefox", "autohide": "2", "allow_embed": 1, "pltype": "contentugc", "fmt_list": "45\/1280x720\/99\/0\/0,22\/1280x720\/9\/0\/115,44\/854x480\/99\/0\/0,35\/854x480\/9\/0\/115,43\/640x360\/99\/0\/0,34\/640x360\/9\/0\/115,18\/640x360\/9\/0\/115,5\/320x240\/7\/0\/0,36\/320x240\/99\/0\/0,17\/176x144\/99\/0\/0", "ucid": "UCSI0StWcKt8hhCQFHTaWnQQ", "hl": "en_US", "csi_page_type": "watch7_html5", "keywords": "Game Of Thrones (TV Series),Interview,bran stark,issac hempsted wright,series,new,latest,2013,launch,episode,full,rose leslie,ygrite,jon snow,stark,ayra,brienne of tarth,television,show,season,one,two,kit harrington,death,scene,best,winterfell,cast,third,hbo,Footage,Premiere,Exclusive,Trailer,official,Interviews,peter dinklage,Episodes,Interview Part", "playlist_module": "http:\/\/s.ytimg.com\/yts\/swfbin\/playlist_module-vfl1Hy15u.swf", "cplatform": "DESKTOP", "tmi": "1", "endscreen_module": "http:\/\/s.ytimg.com\/yts\/swfbin\/endscreen-vflMcugYK.swf", "watermark": ",http:\/\/s.ytimg.com\/yts\/img\/watermark\/youtube_watermark-vflHX6b6E.png,http:\/\/s.ytimg.com\/yts\/img\/watermark\/youtube_hd_watermark-vflAzLcD6.png", "t": "vjVQa1PpcFNRimxSUq9424_AYeA55c_Ci3zY0vnAc_M=", "showpopout": 1, "rvs": "featured=1\u0026title=Game+of+Thrones+Loras+Tyrell+Interview+-+Finn+Jones\u0026author=flicksandthecity\u0026length_seconds=815\u0026view_count=39%2C951\u0026id=VmCK3oigRLk\u0026feature_type=fvwp,author=Simone+Boyce\u0026id=tkYUYe4NMUE\u0026view_count=52%2C393\u0026title=Sophie+Turner+on+Incest%2C+King+Robb+and+Playing+an+Underdog+on+%22Game+of+Thrones%22\u0026length_seconds=227,author=flicksandthecity\u0026id=X8DC4kn1uPE\u0026view_count=75%2C851\u0026title=Game+of+Thrones+Tywin+Lannister+Interview%2C+Charles+Dance\u0026length_seconds=163,author=skyatlantic\u0026id=0gDQIB6AHw0\u0026view_count=61%2C885\u0026title=Game+of+Thrones%3A+Thronecast%3A+Uncut+Natalia+Tena+Interview\u0026length_seconds=466,author=Simone+Boyce\u0026id=0fMRXhqKyJU\u0026view_count=54%2C390\u0026title=Maisie+Williams+on+Wanting+to+Be+Like+Arya+and+Growing+up+on+%22Game+of+Thrones%22\u0026length_seconds=206,author=skyatlantic\u0026id=_v1qs4WA1Vg\u0026view_count=155%2C818\u0026title=Game+of+Thrones%3A+Thronecast%3A+Uncut+Sophie+Turner+Interview\u0026length_seconds=614,author=HBOBulgaria\u0026id=pQjAVYi-D2Y\u0026view_count=9%2C036\u0026title=Game+of+Thrones+III+-+Nikolai+Coster+Waldau+for+HBO+Bulgaria%2C+London%2C+02.2013\u0026length_seconds=386,author=sssora\u0026id=jgwuSuAUPJg\u0026view_count=543%2C368\u0026title=%27Game+of+Thrones%27+stars+for+Rolling+Stone+shoot.\u0026length_seconds=111,author=vljordanov\u0026id=jwjrNd3kmnc\u0026view_count=318%2C818\u0026title=Game+of+Thrones+-+Inner+Circle\u0026length_seconds=1444,author=HBOsocial\u0026id=KpKNVuTtZmM\u0026view_count=14%2C144\u0026title=Game+Of+Thrones+Interview+Nikolaj+Coster-Waldau+-+Ser+Jaime+Lannister+-+HBO\u0026length_seconds=290,author=Cian+Gaffney\u0026id=elHaFwbv4BA\u0026view_count=1%2C177%2C498\u0026title=Game+of+Thrones+S2+Deleted+Scenes+-+Irri+and+Doreah\u0026length_seconds=52,author=shudfugup1\u0026id=XduuXZvTqYY\u0026view_count=26%2C276\u0026title=Game+of+Thrones+Deleted+Scene+-+Eddard+Stark%27s+Alternate+Death\u0026length_seconds=44", "c": "WEB", "title": "Game Of Thrones Bran Stark - Issac Hempsted Wright Interview", "cc_module": "http:\/\/s.ytimg.com\/yts\/swfbin\/subtitle_module-vflM6OyY8.swf", "referrer": null, "is_html5_mobile_device": false, "cbrver": "20.0,gzip(gfe),gzip(gfe"}, "url": "http:\/\/s.ytimg.com\/yts\/swfbin\/watch_as3-vfljjFV5L.swf", "params": {"allowscriptaccess": "always", "allowfullscreen": "true", "bgcolor": "#000000"}, "html5": true, "sts": 1579, "url_v9as2": "http:\/\/s.ytimg.com\/yts\/swfbin\/cps-vflF6kCRZ.swf"};</script>    <div id="player-api">')
    videoSet = new (require basedir + 'video_set').VideoSet(doc)

  it 'How doth the little crocodile Improve his shining tail', ->
    expect(videoSet).toBeDefined()
    expect(videoSet.doc).toEqual(doc)
    expect(videoSet.formats.flv['34']).toEqual('360p')

  it 'And pour the waters of the Nile On every golden scale', ->
    spyOn(videoSet, "collector").andReturn('data')
    expect(videoSet.collector()).toEqual('data')

  it 'How cheerfully he seems to grin', ->

  it 'How neatly spread his claws', ->

  it 'And welcome little fishes in With gently smiling jaws', ->
